import{_ as y}from"./CLgWZ-ys.js";import{g as _,s as i,v as b,c as g,b as u,w as m,o as k,a as s,x as S,y as p,z as d,A as c,q as f,d as x,n as h,B as U}from"./C-ajaEJa.js";import{C as V}from"./BLUqDWYA.js";import{u as B}from"./BmBLMpJm.js";const C={class:"max-w-md mx-auto"},M={class:"mt-3 text-sm text-gray-400"},z=_({__name:"login",setup(N){const l=B(),e=i(""),a=i(""),w=b(),v=async()=>{try{await $fetch("/api/auth/login",{method:"POST",body:{email:e.value,password:a.value}});const o=await $fetch("/api/auth/me");w.setUser(o);try{const t=await $fetch("/api/plan/latest"),n=h();t?.workouts&&n.setWorkouts(t.workouts),t?.meta&&n.setMeta(t.meta)}catch{}l.success("เข้าสู่ระบบสำเร็จ"),await U("/")}catch(o){l.error(o?.statusMessage||"เข้าสู่ระบบไม่สำเร็จ")}};return(o,t)=>{const n=y;return k(),g("div",C,[u(V,null,{default:m(()=>[t[5]||(t[5]=s("h2",{class:"text-2xl font-semibold mb-4"},"เข้าสู่ระบบ",-1)),s("form",{onSubmit:S(v,["prevent"]),class:"space-y-3"},[p(s("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>d(e)?e.value=r:null),placeholder:"อีเมล",class:"form-input"},null,512),[[c,f(e)]]),p(s("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>d(a)?a.value=r:null),type:"password",placeholder:"รหัสผ่าน",class:"form-input"},null,512),[[c,f(a)]]),t[2]||(t[2]=s("button",{class:"w-full btn-primary"},"เข้าสู่ระบบ",-1))],32),s("p",M,[t[4]||(t[4]=x("ยังไม่มีบัญชี? ",-1)),u(n,{to:"/register",class:"text-skyx-400"},{default:m(()=>[...t[3]||(t[3]=[x("สมัครสมาชิก",-1)])]),_:1})])]),_:1})])}}});export{z as default};
