{"file":"planner-C1xm64zD.js","mappings":"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","names":["_push","_parent","_unref","_ssrInterpolate","_ssrRenderAttr","_ssrLooseContain","_ssrLooseEqual","_","_scopeId","_createVNode","_createBlock","_toDisplayString","TimeHMSInput","_openBlock","_Fragment","_renderList","WorkoutTypeBadge"],"sources":["../../../../pages/planner.vue"],"sourcesContent":["<template>\n  <Card>\n    <h2 class=\"text-xl font-semibold mb-4\">สร้างตารางซ้อม</h2>\n    <div v-if=\"hasPlan\" class=\"rounded-xl border border-white/10 p-4 bg-ink-800/60 mb-4\">\n      <div class=\"flex items-center justify-between\">\n        <div>\n          <div class=\"font-medium\">มีแผนปัจจุบันอยู่แล้ว</div>\n          <div class=\"text-sm text-gray-400\">ระยะ {{ meta.distanceKm || '—' }} กม. | เวลาเป้าหมาย {{ formatHMS(meta.goalSeconds) }} | วันแข่ง {{ meta.raceDate ? new Date(meta.raceDate).toLocaleDateString() : '—' }}</div>\n        </div>\n        <button class=\"btn-ghost\" @click.prevent=\"onDeletePlan\">ลบแผนเดิม</button>\n      </div>\n      <p class=\"text-xs text-gray-400 mt-2\">ต้องลบแผนเดิมก่อน จึงจะสร้างแผนใหม่ได้</p>\n    </div>\n    <form v-if=\"!hasPlan\"  @submit.prevent=\"create\" class=\"grid md:grid-cols-4 gap-4\">\n      <div class=\"md:col-span-1\">\n        <label class=\"form-label\">ระยะ</label>\n        <select v-model.number=\"distanceKm\" class=\"form-input\">\n          <option :value=\"5\">5K</option>\n          <option :value=\"10\">10K</option>\n          <option :value=\"21.097\">Half Marathon</option>\n          <option :value=\"42.195\">Marathon</option>\n          <option :value=\"1.5\">1500m (ลู่)</option>\n        </select>\n      </div>\n      <div class=\"md:col-span-1\">\n        <label class=\"form-label\">วันแข่ง</label>\n        <input v-model=\"raceDate\" type=\"date\" class=\"form-input\"/>\n      </div>\n      <div class=\"md:col-span-1\">\n        <label class=\"form-label\">วันวิ่งยาว</label>\n        <select v-model=\"longRunDay\" class=\"form-input\">\n          <option value=\"Mon\">จันทร์</option>\n          <option value=\"Tue\">อังคาร</option>\n          <option value=\"Wed\">พุธ</option>\n          <option value=\"Thu\">พฤหัสฯ</option>\n          <option value=\"Fri\">ศุกร์</option>\n          <option value=\"Sat\">เสาร์</option>\n          <option value=\"Sun\">อาทิตย์</option>\n        </select>\n      </div>\n      <div class=\"md:col-span-1\">\n\n        <label class=\"form-label\">เวลาเป้าหมาย (hh:mm:ss)</label>\n        <TimeHMSInput v-model=\"goalSeconds\" />\n      </div>\n      <div class=\"md:col-span-4 flex items-center gap-3\">\n        <button class=\"btn-accent\">สร้างแผน</button>\n        <NuxtLink v-if=\"workouts.length\" to=\"/calendar\" class=\"btn-ghost\">ดูใน Calendar</NuxtLink>\n      </div>\n    </form>\n\n    <div v-if=\"workouts.length\" class=\"mt-6\">\n      <h3 class=\"font-semibold mb-3\">ตัวอย่างสัปดาห์แรก</h3>\n      <div class=\"grid sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n        <div v-for=\"w in workouts.slice(0,7)\" :key=\"w.id\" class=\"rounded-xl border border-white/10 p-4 bg-ink-800/60\">\n          <div class=\"text-sm text-gray-400\">{{ new Date(w.date).toLocaleDateString() }}</div>\n          <div class=\"font-medium text-white\">{{ w.title }}</div>\n          <div class=\"text-sm text-gray-400 mt-1\">{{ w.details }}</div>\n          <div class=\"mt-2\"><WorkoutTypeBadge :type=\"w.type\" /></div>\n        </div>\n      </div>\n    </div>\n  </Card>\n</template>\n<script setup lang=\"ts\">\nimport Card from '@/components/UI/Card.vue'\nimport WorkoutTypeBadge from '@/components/WorkoutTypeBadge.vue'\nimport TimeHMSInput from '@/components/TimeHMSInput.vue'\nimport { useUiStore } from '@/stores/ui'\nconst distanceKm = ref(10)\nconst raceDate = ref(new Date(Date.now()+1000*60*60*24*84).toISOString().slice(0,10))\nconst goalSeconds = ref<number|null>(null)\nconst longRunDay = ref<string>('Sat')\nconst planStore = usePlanStore()\nconst workouts = computed(()=> planStore.workouts)\nconst meta = computed(()=> planStore.planMeta)\nconst hasPlan = computed(()=> workouts.value.length > 0)\nconst ui = useUiStore()\nconst formatHMS = (sec:number|null|undefined)=>{ if(!sec) return '—'; const h=Math.floor(sec/3600), m=Math.floor((sec%3600)/60), s=sec%60; return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}` }\nconst onDeletePlan = async ()=>{\n  const ok = confirm('ยืนยันลบแผนปัจจุบันทั้งหมด?')\n  if (!ok) return\n  try {\n    const del:any = await $fetch('/api/plan/delete', { method: 'POST' })\n    ui.success(`ลบแผนแล้ว (${del.deleted})`)\n    planStore.setWorkouts([]); planStore.setMeta({})\n  } catch (e:any) {\n    ui.error(e?.statusMessage || 'ลบแผนไม่สำเร็จ')\n  }\n}\n\nconst create = async () => {\n  try {\n    const res:any = await $fetch('/api/plan/generate', { method: 'POST', body: { distanceKm: distanceKm.value, raceDate: raceDate.value, goalSeconds: goalSeconds.value, longRunDay: longRunDay.value }})\n    planStore.setWorkouts(res.workouts || []); if (res?.meta) planStore.setMeta(res.meta)\n    ui.success('สร้างแผนสำเร็จ')\n  } catch (e: any) {\n    if (e?.statusCode === 409) {\n      const ok = confirm('คุณมีแผนเดิมอยู่ ต้องลบออกก่อนสร้างใหม่\\nต้องการลบแผนเดิมตอนนี้หรือไม่?')\n      if (ok) {\n        try {\n          const del:any = await $fetch('/api/plan/delete', { method: 'POST' })\n          ui.info(`ลบแผนเดิมแล้ว (${del.deleted} รายการ) ลองกดสร้างอีกครั้ง`)\n        } catch (delErr: any) {\n          ui.error(delErr?.statusMessage || 'ลบแผนเดิมไม่สำเร็จ')\n        }\n      }\n    } else {\n      ui.error(e?.statusMessage || 'สร้างแผนไม่สำเร็จ')\n    }\n  }\n}\n</script>\n"],"version":3}