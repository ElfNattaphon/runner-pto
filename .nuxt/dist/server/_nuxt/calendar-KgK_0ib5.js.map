{"version":3,"file":"calendar-KgK_0ib5.js","sources":["../../../../pages/calendar.vue"],"sourcesContent":["<template>\n  <Card>\n    <div class=\"flex items-center justify-between mb-4\">\n      <h2 class=\"text-xl font-semibold\">ปฏิทินการซ้อม</h2>\n      <a :href=\"icsUrl\" target=\"_blank\" class=\"btn-ghost\">ดาวน์โหลด .ics</a>\n    </div>\n    <FullCalendar :options=\"calendarOptions\" />\n  </Card>\n\n  <div v-if=\"selected\" class=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4\" @click.self=\"selected=null\">\n    <div class=\"w-full max-w-lg rounded-2xl border border-white/10 bg-ink-800/90 backdrop-blur p-5\">\n      <div class=\"flex items-start justify-between gap-3\">\n        <h3 class=\"text-lg font-semibold text-white\">{{ selected.title }}</h3>\n        <button class=\"btn-ghost\" @click=\"selected = null\">ปิด</button>\n      </div>\n      <div class=\"mt-3 space-y-2 text-sm text-gray-300\">\n        <div><span class=\"text-gray-400\">วันที่:</span> {{ formatDate(selected.date) }}</div>\n        <div class=\"flex items-center gap-2\">\n          <span class=\"text-gray-400\">ประเภท:</span>\n          <WorkoutTypeBadge :type=\"(selected.type as any)\" />\n        </div>\n        <div v-if=\"selected.distanceKm\"><span class=\"text-gray-400\">ระยะ:</span> {{ selected.distanceKm }} กม.</div>\n        <div v-if=\"selected.details\" class=\"whitespace-pre-wrap\"><span class=\"text-gray-400\">รายละเอียด:</span> {{ renderDetails(selected) }}</div>\n      </div>\n    </div>\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport { computeHrZones, renderDetailsWithHR } from '@/utils/hr'\nimport Card from '@/components/UI/Card.vue'\nimport WorkoutTypeBadge from '@/components/WorkoutTypeBadge.vue'\nimport FullCalendar from '@fullcalendar/vue3'\nimport dayGridPlugin from '@fullcalendar/daygrid'\nimport interactionPlugin from '@fullcalendar/interaction'\nimport { useUiStore } from '@/stores/ui'\n\ntype Workout = { id: string; date: string | Date; type: 'E'|'M'|'T'|'I'|'R'|'Rest'|'Race'|'LR'; title: string; details?: string; distanceKm?: number }\nconst planStore = usePlanStore()\nconst ui = useUiStore()\nconst selected = ref<Workout|null>(null)\nconst me = await $fetch('/api/auth/me').catch(()=> null)\n\ntype HRProfile = { hrMethod?: 'max'|'threshold'|null; ageYears?: number|null; maxHR?: number|null; thresholdHR?: number|null }\nconst prof = computed<HRProfile | null>(() => ((me as any)?.profile ?? null))\nconst zones = computed(()=> computeHrZones({ method: prof.value?.hrMethod || 'max', maxHR: prof.value?.maxHR ?? null, thresholdHR: prof.value?.thresholdHR ?? null, ageYears: prof.value?.ageYears ?? null }))\nconst renderDetails = (w:any)=> renderDetailsWithHR(w?.details||'', w?.type||'', zones.value)\nconst formatDate = (d: string | Date) => new Date(d).toLocaleDateString()\nconst events = computed(() => planStore.workouts.map((w: Workout) => ({ id:w.id, title:w.title, start: new Date(w.date).toISOString().slice(0,10), allDay:true, classNames:[`evt-${w.type}`], extendedProps:{ workout:w } })))\n\nconst isMobile = ref(false)\nif (process.client) {\n  const set = () => { isMobile.value = window.innerWidth < 640 }\n  set(); window.addEventListener('resize', set)\n  onUnmounted(()=> window.removeEventListener('resize', set))\n}\nconst calendarOptions = reactive({\n  plugins: [dayGridPlugin, interactionPlugin],\n  initialView: isMobile.value ? 'dayGridWeek' : 'dayGridMonth',\n  events,\n  eventClick: (info:any) => { const w = info?.event?.extendedProps?.workout as Workout|undefined; if (w) selected.value = w }\n})\n\nconst { icsUrl } = await $fetch('/api/plan/ics-url'); if (!icsUrl || icsUrl === '#') ui.info('ยังไม่มีแผนสำหรับสร้างไฟล์ .ics')\n</script>\n"],"names":["_withAsyncContext","_push","_parent","_ssrRenderAttr","_unref","_ssrRenderComponent","_createVNode","_ssrInterpolate"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAqCA,UAAM,YAAY,aAAA;AAClB,UAAM,KAAK,WAAA;AACX,UAAM,WAAW,IAAkB,IAAI;AACvC,UAAM,MAAK,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAM,OAAO,cAAc,EAAE,MAAM,MAAK,IAAI,CAAA;AAGvD,UAAM,OAAO,SAA2B,MAAQ,IAAY,WAAW,IAAK;AAC5E,UAAM,QAAQ,SAAS,MAAK,eAAe,EAAE,QAAQ,KAAK,OAAO,YAAY,OAAO,OAAO,KAAK,OAAO,SAAS,MAAM,aAAa,KAAK,OAAO,eAAe,MAAM,UAAU,KAAK,OAAO,YAAY,KAAA,CAAM,CAAC;AAC7M,UAAM,gBAAgB,CAAC,MAAS,oBAAoB,GAAG,WAAS,IAAI,GAAG,QAAM,IAAI,MAAM,KAAK;AAC5F,UAAM,aAAa,CAAC,MAAqB,IAAI,KAAK,CAAC,EAAE,mBAAA;AACrD,UAAM,SAAS,SAAS,MAAM,UAAU,SAAS,IAAI,CAAC,OAAgB,EAAE,IAAG,EAAE,IAAI,OAAM,EAAE,OAAO,OAAO,IAAI,KAAK,EAAE,IAAI,EAAE,cAAc,MAAM,GAAE,EAAE,GAAG,QAAO,MAAM,YAAW,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,eAAc,EAAE,SAAQ,EAAA,EAAE,EAAI,CAAC;AAE7N,UAAM,WAAW,IAAI,KAAK;AAM1B,UAAM,kBAAkB,SAAS;AAAA,MAC/B,SAAS,CAAC,eAAe,iBAAiB;AAAA,MAC1C,aAAa,SAAS,QAAQ,gBAAgB;AAAA,MAC9C;AAAA,MACA,YAAY,CAAC,SAAa;AAAE,cAAM,IAAI,MAAM,OAAO,eAAe;AAA8B,YAAI,YAAY,QAAQ;AAAA,MAAE;AAAA,IAAA,CAC3H;AAED,UAAM,EAAE,OAAA,KAAW,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAM,OAAO,mBAAmB,CAAA;AAAG,QAAI,CAAC,UAAU,WAAW,IAAK,IAAG,KAAK,iCAAiC;;;;yBA7D5H,CAMO,GAAAC,QAAAC,UAAA,aAAA;;sJAHCC,cAAA,QAAMC,MAAA,MAAA,CAAM;AAEHH,mBAAAI,mBAAAD,MAAA,YAAA,GAAA,EAAA,SAASA,MAAA,eAAA,EAAA,GAAe,MAAAF,UAAA,QAAA,CAAA;AAAA;;cAJvCI,YAGM,OAAA,EAHD,OAAM,4CAAwC;AAAA,gBACjDA,YAAoD,MAAA,EAAhD,OAAM,wBAAA,GAAwB,eAAa;AAAA,gBAC/CA,YAAsE,KAAA;AAAA,kBAAlE,MAAMF,MAAA,MAAA;AAAA,kBAAQ,QAAO;AAAA,kBAAS,OAAM;AAAA,gBAAA,GAAY,kBAAc,GAAA,CAAA,MAAA,CAAA;AAAA,cAAA;cAEpEE,YAA2CF,MAAA,YAAA,GAAA,EAA5B,SAASA,MAAA,eAAA,KAAe,MAAA,GAAA,CAAA,SAAA,CAAA;AAAA,YAAA;AAAA;;;;UAG9BA,MAAA,QAAA,GAAQ;mSAGmCG,eAAAH,MAAA,QAAA,EAAS,KAAK,sKAIX,WAAWA,MAAA,QAAA,EAAS,IAAI,CAAA;;UAGtD,MAAOA,MAAA,QAAA,EAAS;AAAA,QAAA;;AAE1B,YAAAA,MAAA,QAAA,EAAS,YAAU;AAA8C,gBAAA,iDAAAG,eAAAH,MAAA,QAAA,EAAS,UAAU,CAAA,YAAA;AAAA;;;AACpF,YAAAA,MAAA,QAAA,EAAS,SAAO;AAAgF,gBAAA,mFAAAG,eAAA,cAAcH,MAAA,QAAA,CAAQ,CAAA,CAAA,QAAA;AAAA;;;;;;;;;;;;;;;;;"}