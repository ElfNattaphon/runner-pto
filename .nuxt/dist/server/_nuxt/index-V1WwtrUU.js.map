{"version":3,"file":"index-V1WwtrUU.js","sources":["../../../../components/UI/Stat.vue","../../../../pages/index.vue"],"sourcesContent":["<template>\n  <Card>\n    <div class=\"text-sm text-gray-400\">{{ title }}</div>\n    <div class=\"text-2xl font-semibold text-white mt-1\">{{ value }}</div>\n    <div v-if=\"sub\" class=\"text-xs text-gray-500 mt-1\">{{ sub }}</div>\n  </Card>\n</template>\n<script setup lang=\"ts\">\nimport Card from '@/components/UI/Card.vue'\nconst props = defineProps<{ title: string; value: string; sub?: string }>()\n</script>\n","<template>\n  <div class=\"space-y-6\">\n    <div class=\"flex items-end justify-between\">\n      <div>\n        <h1 class=\"text-2xl font-semibold\">สวัสดี {{ me?.profile?.fullName || me?.email }}</h1>\n        <p class=\"text-gray-400\">จัดการตารางซ้อมของคุณได้จากที่นี่</p>\n      </div>\n      <NuxtLink to=\"/planner\" class=\"btn-accent\">เริ่มสร้างแผน</NuxtLink>\n    </div>\n\n    <div class=\"grid md:grid-cols-3 gap-6\">\n      <UIStat title=\"สัปดาห์นี้\" :value=\"weeklyKm + ' กม.'\" sub=\"ระยะรวมตามแผน\"/>\n      <UIStat title=\"วันวิ่งยาว\" :value=\"me?.profile?.longRunDay || meta.longRunDay || 'Sat'\" sub=\"วันประจำสัปดาห์\"/>\n      <UIStat title=\"ระยะเป้าหมาย\" :value=\"lastGoal\" sub=\"จากแผนล่าสุด\"/>\n    </div>\n\n    <Card>\n      <h2 class=\"text-lg font-semibold mb-2\">แผนปัจจุบัน</h2>\n      <div class=\"text-sm text-gray-300 space-y-1\">\n        <div>ระยะ: <span class=\"font-medium\">{{ meta.distanceKm ? meta.distanceKm + ' กม.' : '—' }}</span></div>\n        <div>เวลาเป้าหมาย: <span class=\"font-medium\">{{ formatHMS(meta.goalSeconds) }}</span></div>\n        <div>วันแข่ง: <span class=\"font-medium\">{{ meta.raceDate ? new Date(meta.raceDate).toLocaleDateString() : '—' }}</span></div>\n      </div>\n      <div class=\"mt-3\">\n        <h3 class=\"text-sm font-semibold mb-1\">โซนหัวใจ (ประมาณการ)</h3>\n        <ul class=\"text-xs text-gray-300 space-y-0.5\">\n          <li>Easy / Long Run: Z2</li>\n          <li>Marathon: Z3</li>\n          <li>Tempo: Z3–Z4</li>\n          <li>Intervals: Z4</li>\n          <li>Reps: Z5</li>\n        </ul>\n        <p class=\"text-[11px] text-gray-400 mt-2\">* คำนวณจาก Threshold/Max HR ในโปรไฟล์ หากใส่ค่าครบจะระบุ BPM ในรายละเอียดคิวซ้อม</p>\n      </div>\n    </Card>\n\n    <Card>\n      <h2 class=\"text-lg font-semibold mb-3\">สรุปสัปดาห์แรก</h2>\n      <ul class=\"divide-y divide-white/10\">\n        <li v-for=\"w in workouts.slice(0,7)\" :key=\"w.id\" class=\"py-2 flex items-center justify-between\">\n          <div class=\"space-y-0.5\">\n            <div class=\"font-medium\">{{ new Date(w.date).toLocaleDateString() }} — {{ w.title }}</div>\n            <div class=\"text-sm text-gray-400\">{{ renderDetails(w) }}</div>\n          </div>\n          <WorkoutTypeBadge :type=\"w.type\" />\n        </li>\n      </ul>\n      <div class=\"mt-4\">\n        <NuxtLink to=\"/calendar\" class=\"text-skyx-400 hover:underline\">เปิดปฏิทิน</NuxtLink>\n      </div>\n    </Card>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computeHrZones, renderDetailsWithHR } from '@/utils/hr'\nimport Card from '@/components/UI/Card.vue'\nimport UIStat from '@/components/UI/Stat.vue'\nimport WorkoutTypeBadge from '@/components/WorkoutTypeBadge.vue'\n\nconst me = await $fetch('/api/auth/me').catch(()=> null)\n\ntype HRProfile = { hrMethod?: 'max'|'threshold'|null; ageYears?: number|null; maxHR?: number|null; thresholdHR?: number|null }\nconst prof = computed<HRProfile | null>(() => ((me as any)?.profile ?? null))\nconst zones = computed(()=> computeHrZones({ method: prof.value?.hrMethod || 'max', maxHR: prof.value?.maxHR ?? null, thresholdHR: prof.value?.thresholdHR ?? null, ageYears: prof.value?.ageYears ?? null }))\nconst renderDetails = (w:any)=> renderDetailsWithHR(w?.details||'', w?.type||'', zones.value)\nconst planStore = usePlanStore()\nconst workouts = computed(()=> planStore.workouts)\nconst meta = computed(()=> planStore.planMeta)\nconst weeklyKm = computed(()=> Math.round(workouts.value.slice(0,7).reduce((s,w)=> s + (w.distanceKm||0), 0)))\nconst lastGoal = '—'\n\nconst formatHMS = (sec: number | null | undefined) => {\n  if (!sec) return '—';\n  const h = Math.floor(sec / 3600);\n  const m = Math.floor((sec % 3600) / 60);\n  const s = sec % 60;\n  return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`\n}\n\n// Auto load latest plan if store empty\nonMounted(async ()=>{\n  if (!planStore.workouts.length) {\n    try {\n      const latest:any = await $fetch('/api/plan/latest')\n      if (latest?.workouts) planStore.setWorkouts(latest.workouts)\n      if (latest?.meta) planStore.setMeta(latest.meta)\n    } catch {}\n  }\n})\n</script>\n"],"names":["_push","_parent","title","value","sub","_createVNode","_createBlock","_withAsyncContext","_ssrRenderAttrs","_mergeProps","_ssrInterpolate","_unref","_toDisplayString","_","_scopeId","_openBlock","_Fragment","_renderList","WorkoutTypeBadge"],"mappings":"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"}