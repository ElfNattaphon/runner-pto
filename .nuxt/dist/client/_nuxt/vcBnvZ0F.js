import{_ as $}from"./CLgWZ-ys.js";import{c as H,r as Z}from"./TqiFiJ8V.js";import{C as g}from"./BLUqDWYA.js";import{g as k,j as C,o as p,w as c,a as t,c as v,k as N,t as l,l as B,m as u,n as L,p as K,b as n,q as a,d as m,F as V,r as j}from"./C-ajaEJa.js";import{_ as T}from"./DssN87-j.js";const E={class:"text-sm text-gray-400"},F={class:"text-2xl font-semibold text-white mt-1"},P={key:0,class:"text-xs text-gray-500 mt-1"},h=k({__name:"Stat",props:{title:{},value:{},sub:{}},setup(S){return(o,y)=>(p(),C(g,null,{default:c(()=>[t("div",E,l(o.title),1),t("div",F,l(o.value),1),o.sub?(p(),v("div",P,l(o.sub),1)):N("",!0)]),_:1}))}}),W={class:"space-y-6"},Y={class:"flex items-end justify-between"},q={class:"text-2xl font-semibold"},z={class:"grid md:grid-cols-3 gap-6"},A={class:"text-sm text-gray-300 space-y-1"},G={class:"font-medium"},I={class:"font-medium"},J={class:"font-medium"},O={class:"divide-y divide-white/10"},Q={class:"space-y-0.5"},U={class:"font-medium"},X={class:"text-sm text-gray-400"},tt={class:"mt-4"},et="—",it=k({__name:"index",async setup(S){let o,y;const _=([o,y]=B(()=>$fetch("/api/auth/me").catch(()=>null)),o=await o,y(),o),f=u(()=>_?.profile??null),w=u(()=>H({method:f.value?.hrMethod||"max",maxHR:f.value?.maxHR??null,thresholdHR:f.value?.thresholdHR??null,ageYears:f.value?.ageYears??null})),D=s=>Z(s?.details||"",s?.type||"",w.value),d=L(),b=u(()=>d.workouts),r=u(()=>d.planMeta),M=u(()=>Math.round(b.value.slice(0,7).reduce((s,e)=>s+(e.distanceKm||0),0))),R=s=>{if(!s)return"—";const e=Math.floor(s/3600),x=Math.floor(s%3600/60),i=s%60;return`${String(e).padStart(2,"0")}:${String(x).padStart(2,"0")}:${String(i).padStart(2,"0")}`};return K(async()=>{if(!d.workouts.length)try{const s=await $fetch("/api/plan/latest");s?.workouts&&d.setWorkouts(s.workouts),s?.meta&&d.setMeta(s.meta)}catch{}}),(s,e)=>{const x=$;return p(),v("div",W,[t("div",Y,[t("div",null,[t("h1",q,"สวัสดี "+l(a(_)?.profile?.fullName||a(_)?.email),1),e[0]||(e[0]=t("p",{class:"text-gray-400"},"จัดการตารางซ้อมของคุณได้จากที่นี่",-1))]),n(x,{to:"/planner",class:"btn-accent"},{default:c(()=>[...e[1]||(e[1]=[m("เริ่มสร้างแผน",-1)])]),_:1})]),t("div",z,[n(h,{title:"สัปดาห์นี้",value:a(M)+" กม.",sub:"ระยะรวมตามแผน"},null,8,["value"]),n(h,{title:"วันวิ่งยาว",value:a(_)?.profile?.longRunDay||a(r).longRunDay||"Sat",sub:"วันประจำสัปดาห์"},null,8,["value"]),n(h,{title:"ระยะเป้าหมาย",value:et,sub:"จากแผนล่าสุด"})]),n(g,null,{default:c(()=>[e[5]||(e[5]=t("h2",{class:"text-lg font-semibold mb-2"},"แผนปัจจุบัน",-1)),t("div",A,[t("div",null,[e[2]||(e[2]=m("ระยะ: ",-1)),t("span",G,l(a(r).distanceKm?a(r).distanceKm+" กม.":"—"),1)]),t("div",null,[e[3]||(e[3]=m("เวลาเป้าหมาย: ",-1)),t("span",I,l(R(a(r).goalSeconds)),1)]),t("div",null,[e[4]||(e[4]=m("วันแข่ง: ",-1)),t("span",J,l(a(r).raceDate?new Date(a(r).raceDate).toLocaleDateString():"—"),1)])]),e[6]||(e[6]=t("div",{class:"mt-3"},[t("h3",{class:"text-sm font-semibold mb-1"},"โซนหัวใจ (ประมาณการ)"),t("ul",{class:"text-xs text-gray-300 space-y-0.5"},[t("li",null,"Easy / Long Run: Z2"),t("li",null,"Marathon: Z3"),t("li",null,"Tempo: Z3–Z4"),t("li",null,"Intervals: Z4"),t("li",null,"Reps: Z5")]),t("p",{class:"text-[11px] text-gray-400 mt-2"},"* คำนวณจาก Threshold/Max HR ในโปรไฟล์ หากใส่ค่าครบจะระบุ BPM ในรายละเอียดคิวซ้อม")],-1))]),_:1}),n(g,null,{default:c(()=>[e[8]||(e[8]=t("h2",{class:"text-lg font-semibold mb-3"},"สรุปสัปดาห์แรก",-1)),t("ul",O,[(p(!0),v(V,null,j(a(b).slice(0,7),i=>(p(),v("li",{key:i.id,class:"py-2 flex items-center justify-between"},[t("div",Q,[t("div",U,l(new Date(i.date).toLocaleDateString())+" — "+l(i.title),1),t("div",X,l(D(i)),1)]),n(T,{type:i.type},null,8,["type"])]))),128))]),t("div",tt,[n(x,{to:"/calendar",class:"text-skyx-400 hover:underline"},{default:c(()=>[...e[7]||(e[7]=[m("เปิดปฏิทิน",-1)])]),_:1})])]),_:1})])}}});export{it as default};
